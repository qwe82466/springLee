<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:security="http://www.springframework.org/schema/security"
	xsi:schemaLocation="http://www.springframework.org/schema/beans 
	http://www.springframework.org/schema/beans/spring-beans.xsd 
	http://www.springframework.org/schema/security 
	http://www.springframework.org/schema/security/spring-security.xsd">
	<!-- 시큐리티 설정 파일 -->
	
	<!-- 비밀번호 보호를 위함 암호화 클래스 빈으로 등록  -->
	<bean id="bcryptPasswordEncoder" class="org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder" />
	<!-- 시큐리티에서 우리가 원하는 형태의 회원테이블로 처리되기 위한 클래스 빈으로 등록  -->
	<bean id="customUserDetailsService" class="com.member.service.CustomUserDetailsService" />
	
	
	<!-- 접근 제한 설정 -->
	<security:http>
		<!-- 특정 URI에 접근 제한 설정 -->
		<security:intercept-url pattern="/common/*" access="permitAll" />
		<security:intercept-url pattern="/member/*" access="hasRole('ROLE_MEMBER')" />
		<security:intercept-url pattern="/admin/*" access="hasRole('ROLE_ADMIN')" />
	
		<!-- 시큐리티 로그인페이지를 커스텀 경로로 변경(우리가만든 로그인폼 경로) -->
		<security:form-login login-page="/common/login" />
		
		<security:logout logout-url="/logout" invalidate-session="true" delete-cookies="JSESSION_ID" logout-success-url="/common/main"/>
		
	</security:http>

	<!-- 인증과 권한 처리해주는 태그  -->
	<security:authentication-manager>
		
		<!-- 권한에 대한 인증 해주는 authentication-provider -->
		<security:authentication-provider user-service-ref="customUserDetailsService">
			<security:password-encoder ref="bcryptPasswordEncoder" />
		</security:authentication-provider>
	
	</security:authentication-manager>

</beans>
